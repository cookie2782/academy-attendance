# 학원 등원/하원 자동 알림 시스템 v2.0

엑셀 파일의 등원/하원 상태 변화를 실시간으로 모니터링하여 자동으로 **SMS 또는 카카오톡 알림**을 발송하는 시스템입니다.

## ✨ v2.0 새로운 기능

- ✅ **카카오톡 알림톡 지원** (SMS보다 50% 저렴!)
- ✅ **GUI 입력 프로그램** (마우스 클릭으로 간편 등/하원 처리)
- ✅ **다양한 SMS/카카오톡 API 지원**
- ✅ **실시간 자동 모니터링**

## 📋 주요 기능

### 💬 메시지 전송
- **SMS**: 네이버 클라우드, 쿨SMS, 알리고
- **카카오톡**: 알리고 카카오톡, 네이버 클라우드 카카오톡, 카카오 비즈니스 API
- 테스트 모드 지원

### 🖥️ 입력 방법
1. **GUI 프로그램** (추천!): 마우스 클릭으로 간편 조작
2. **콘솔 프로그램**: 키보드로 빠른 입력
3. **엑셀 직접 수정**: 기존 방식

### 📊 모니터링
- 엑셀 파일 실시간 감지
- 자동 상태 변화 감지
- 즉시 알림 발송

## 🚀 빠른 시작

### 1단계: 패키지 설치
```bash
pip install -r requirements.txt
```

### 2단계: 입력 프로그램 실행
```bash
# GUI 버전 (추천!)
등하원입력_GUI.bat

# 또는 콘솔 버전
등하원입력_콘솔.bat
```

### 3단계: 학생 등/하원 처리
- 학생 선택 → [등원] 또는 [하원] 버튼 클릭 → 완료!

## 📱 SMS vs 카카오톡

### 비교표

| 항목 | SMS | 카카오톡 |
|------|-----|----------|
| 비용 | 12~20원/건 | 5~9원/건 ⭐ |
| 도달률 | 95% | 99%+ ⭐ |
| 설정 | 간단 | 템플릿 승인 필요 |
| 즉시확인 | ✓ | ✓ |
| 이미지 | ✗ | ✓ |

**카카오톡이 약 50% 저렴하고 도달률도 높아요!**

### 카카오톡 설정 (5분!)

#### 방법 1: 알리고 카카오톡 (가장 간편, 추천!)

1. **알리고 가입**: https://smartsms.aligo.in/
2. **카카오톡 채널 생성**: https://center-pf.kakao.com/
3. **채널 연결**: 알리고 → 카카오 알림톡 → 발신프로필 관리
4. **템플릿 등록**: 아래 템플릿 사용
5. **설정 완료**: sms_config.json 수정

**템플릿 예시:**
```
[OO학원]

#{이름}님이 #{상태}하였습니다.

• 시각: #{시각}

학부모님께 알려드립니다.

※ 본 메시지는 자동 발송됩니다.
```

**설정 파일 (sms_config.json):**
```json
{
  "message_type": "kakao",
  "provider": "kakao_aligo",
  "test_mode": false,
  "kakao_aligo": {
    "api_key": "여기에_API_키",
    "user_id": "여기에_사용자_ID",
    "sender_key": "여기에_발신키",
    "template_code": "승인된_템플릿코드"
  }
}
```

**자세한 가이드**: `카카오톡_빠른시작.txt` 참조

## 🎯 사용 방법

### GUI 프로그램 (추천!)

```bash
등하원입력_GUI.bat
```

**화면:**
```
┌────────────────────────────────────────┐
│  OO학원 등원/하원 관리                  │
│                                        │
│  번호  이름    연락처        현재상태   │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━   │
│  1    홍길동  010-1234-5678  ○ 하원   │
│  2    김영희  010-2345-6789  ✓ 등원중 │
│                                        │
│  [✓ 등원]  [✗ 하원]  [🔄 새로고침]    │
└────────────────────────────────────────┘
```

1. 학생 이름 클릭
2. [등원] 또는 [하원] 버튼
3. 자동으로 메시지 발송!

### 자동 모니터링 (선택사항)

```bash
실행.bat
```

- 백그라운드에서 엑셀 파일 모니터링
- 상태 변화 자동 감지
- 즉시 메시지 발송

## ⚙️ 설정

### config.json - 기본 설정
```json
{
  "academy_name": "OO학원",
  "check_interval": 5,
  "name_column": "A",
  "phone_column": "B",
  "status_column": "C",
  "start_row": 2
}
```

### sms_config.json - 메시지 설정

#### SMS 사용
```json
{
  "message_type": "sms",
  "provider": "naver",
  "test_mode": true
}
```

#### 카카오톡 사용
```json
{
  "message_type": "kakao",
  "provider": "kakao_aligo",
  "test_mode": true
}
```

## 📊 엑셀 파일 구조

| A열 (이름) | B열 (연락처) | C열 (상태) |
|-----------|-------------|-----------|
| 홍길동     | 010-1234-5678 | 0 |
| 김영희     | 010-2345-6789 | 1 |

- **C열**: `0` = 하원, `1` = 등원
- **상태 변경**: 입력 프로그램 사용 (엑셀 직접 수정 불필요!)

## 💰 비용 안내

### SMS (건당)
- 네이버 클라우드: 12~15원
- 쿨SMS: 15~20원
- 알리고: 12~15원

### 카카오톡 (건당) ⭐ 추천
- 알리고 카카오톡: 5~7원
- 네이버 클라우드: 7~9원

**월 100건 기준:**
- SMS: 1,200~2,000원
- 카카오톡: 500~900원
- **약 50% 절감!**

## 📁 파일 구조

```
자동알림문자/
├── 실행 파일
│   ├── 등하원입력_GUI.bat          ⭐ GUI 입력 프로그램
│   ├── 등하원입력_콘솔.bat         콘솔 입력 프로그램
│   └── 실행.bat                    자동 모니터링
│
├── 핵심 모듈
│   ├── attendance_monitor.py       엑셀 모니터링
│   ├── attendance_gui.py           GUI 프로그램
│   ├── attendance_input.py         콘솔 프로그램
│   └── sms_sender.py              메시지 전송
│
├── 설정 파일
│   ├── config.json                 기본 설정
│   ├── sms_config.json            메시지 설정
│   └── 202511_자동알림.xlsx        학생 명단
│
└── 안내 문서
    ├── 전체_시스템_안내.txt        종합 안내
    ├── 카카오톡_빠른시작.txt       카카오톡 5분 설정
    ├── 카카오톡설정가이드.txt      카카오톡 상세 가이드
    ├── 카카오톡템플릿예시.txt      템플릿 예시
    └── 등하원입력_사용법.txt       입력 프로그램 가이드
```

## 🔧 문제 해결

### Q: 카카오톡이 안 가요
**A:** 
- ☑ test_mode가 false인가요?
- ☑ 템플릿이 승인되었나요?
- ☑ API 키가 정확한가요?
- ☑ 포인트 잔액이 있나요?

### Q: GUI가 실행이 안 돼요
**A:** `등하원입력_GUI.bat` 파일을 더블클릭하세요

### Q: SMS와 카카오톡 중 뭐가 좋아요?
**A:** 카카오톡 추천! 더 저렴하고(50% 절감) 도달률도 높아요

### Q: 카카오톡 설정이 어려워요
**A:** `카카오톡_빠른시작.txt` 파일을 보시면 5분이면 완료됩니다!

## 📖 상세 가이드

- **전체 시스템**: `전체_시스템_안내.txt`
- **카카오톡 설정**: `카카오톡_빠른시작.txt` (5분 완성)
- **카카오톡 상세**: `카카오톡설정가이드.txt`
- **템플릿 예시**: `카카오톡템플릿예시.txt`
- **입력 프로그램**: `등하원입력_사용법.txt`

## 🎓 추천 사용 방법

### 초보자
1. `등하원입력_GUI.bat` 실행
2. 학생 선택 → 버튼 클릭
3. 완료!

### 중급자
1. 카카오톡 설정 (5분)
2. `등하원입력_GUI.bat` 사용
3. 자동으로 카카오톡 발송

### 고급자
1. `실행.bat` (자동 모니터링)
2. `등하원입력_GUI.bat` (입력)
3. 완벽한 자동화!

## 📄 라이선스

이 프로젝트는 개인 및 상업적 용도로 자유롭게 사용할 수 있습니다.

## 🆕 업데이트 내역

### v2.0 (현재)
- ✅ 카카오톡 알림톡 지원 추가
- ✅ GUI 입력 프로그램 추가
- ✅ 다양한 메시지 API 지원
- ✅ 상세 가이드 문서 추가

### v1.0
- 기본 SMS 전송 기능
- 엑셀 모니터링 기능

---

**더 자세한 내용은 각 txt 파일을 참조하세요!**

